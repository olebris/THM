# üíº Basic Pentesting

{% embed url="https://tryhackme.com/r/room/basicpentestingjt" %}

Lien Gitbook : [https://olb.gitbook.io/thm-ctf-write-ups/basic-pentesting](https://olb.gitbook.io/thm-ctf-write-ups/basic-pentesting)

IP=10.10.57.76 &#x20;

## Nmap&#x20;

R√©sultats:

* Port 22 SSH open&#x20;
* Port 80 http open -Apache 2.4.18&#x20;
* Port 139 / 445 samba open&#x20;
* Port 8080 http open ‚ÄìApache Tomcat/9.0.7&#x20;
* Port 8009 ajp13  ???

&#x20;[https://book.hacktricks.xyz/network-services-pentesting/8009-pentesting-apache-jserv-protocol-ajp](https://book.hacktricks.xyz/network-services-pentesting/8009-pentesting-apache-jserv-protocol-ajp)&#x20;

* Exploitation via Metasploit de ajp  : RAS &#x20;

## &#x20;Nikto&#x20;

```
nikto -h 10.10.57.76
```

&#x20;R√©sultat: `+ /development/: Directory indexing found`&#x20;

&#x20;On se rend sur `/development/`

<img src="https://lh7-us.googleusercontent.com/lnbANnNfmr9A-wz2Bryp-9vsmW_viu64YV3Vmdc4H7nUBqczCZlCSph4tU6XJR8drR9uz1b4QGq7FcxHo95dlt6khUsolRM0dhJlhx6LGcjCQf9fMP85YS55sVYW2vzfnz8XjDJgptr2DJuYvPicliw" alt="" data-size="original">

&#x20;On lit : [http://10.10.57.76/development/dev.txt\
](http://10.10.57.76/development/dev.txt)

* User K and user J ?&#x20;
* version 2.5.12 ? Struts ?&#x20;
* SMB (√† creuser)&#x20;

On lit aussi : [http://10.10.57.76/development/j.txt](http://10.10.57.76/development/j.txt)&#x20;

* J a un mdp faible (brute force de J ?)&#x20;

## Enum4linux&#x20;

```
enum4linux 10.10.57.76 | tee enum.txt
```

R√©sultat:

* \[+] Enumerating users using SID S-1-22-1 and logon username '', password ''&#x20;

`S-1-22-1-1000 Unix User\kay (Local User)`&#x20;

`S-1-22-1-1001 Unix User\jan (Local User)`&#x20;

&#x20;Donc d√©sormais:

* On a nos user J et K => jan et kay&#x20;
* Jan a un mdp faible donc => brute force via Hydra sur ssh&#x20;

## Brute force SSH (hydra)

```
hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.10.57.76 ssh  -V 
```

<figure><img src=".gitbook/assets/image (63).png" alt=""><figcaption></figcaption></figure>

```
ssh jan@10.10.57.76 
```

`jan:armando`&#x20;

![](https://lh7-us.googleusercontent.com/\_UzGvjexJEu6Fwdvqfv448VoWwGGtob-u75kqd0kWJMYJ0Vzd9YxiPfGOxQR9ALqftD2D0IZjhvlcT7vBrD8dpQOIOQ3AAi5brj7VWDqyvZNpKPlAZ5sEfn7TlQLzyBDONEUyr26MBd4izLLxyR0XA4)

## &#x20;PrivEsc

* sudo ‚Äìl => pas permis&#x20;
* Fichiers /etc/xxx => pas de permission&#x20;
* SUID/GUID &#x20;

`find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2> /dev/null`   => RAS&#x20;

Utilisation de[ linpeas](https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS) pour chercher une √©l√©vation de privil√®ge √©ventuelle ?&#x20;

* Il faut le charger sur la VM cible&#x20;
* Pas d'√©criture possible sur `/home/jan` donc on va sur `/tmp`&#x20;

<figure><img src=".gitbook/assets/image (65).png" alt=""><figcaption></figcaption></figure>

* On lance un serveur python sur sa Kali&#x20;

<figure><img src=".gitbook/assets/image (64).png" alt=""><figcaption></figcaption></figure>

* Et un wget sur la VM cible&#x20;

<figure><img src=".gitbook/assets/image (66).png" alt=""><figcaption></figcaption></figure>

On execute `linpeas.sh`

<figure><img src=".gitbook/assets/image (67).png" alt=""><figcaption></figcaption></figure>

&#x20;Linpeas nous informe qu'une cl√© priv√©e est sur le r√©pertoire home de kay !!

<figure><img src=".gitbook/assets/image (69).png" alt=""><figcaption></figcaption></figure>

On la r√©cup√®re dans un fichier kay.private et on essaye de se connecter en ssh avec &#x20;

<figure><img src=".gitbook/assets/image (71).png" alt=""><figcaption></figcaption></figure>

La cl√© est partag√©e par passphrase.

On la brute force avec john:

<figure><img src=".gitbook/assets/image (73).png" alt=""><figcaption></figcaption></figure>

Passphrase:`beeswax`&#x20;

On se connecte en ssh avec la cl√© RSA de kay et la passphrase:

<figure><img src=".gitbook/assets/image (74).png" alt=""><figcaption></figcaption></figure>

Flag final dans le r√©pertoire home de kay&#x20;

<figure><img src=".gitbook/assets/image (75).png" alt=""><figcaption></figcaption></figure>

&#x20;

&#x20;

&#x20;

&#x20;

&#x20;

&#x20;

&#x20;

&#x20;

&#x20;

\
